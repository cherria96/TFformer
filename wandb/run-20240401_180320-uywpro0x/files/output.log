GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/user126/anaconda3/envs/dt_idl/lib/python3.11/site-packages/torch/nn/init.py:412: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
/home/user126/anaconda3/envs/dt_idl/lib/python3.11/site-packages/pytorch_lightning/trainer/configuration_validator.py:108: PossibleUserWarning: You defined a `validation_step` but have no `val_dataloader`. Skipping val loop.
  rank_zero_warn(
  | Name                       | Type                       | Params
--------------------------------------------------------------------------
0 | A_input_transformation     | Linear                     | 80
1 | X_input_transformation     | Linear                     | 16
2 | Y_input_transformation     | Linear                     | 32
3 | V_input_transformation     | Linear                     | 32
4 | self_positional_encoding_k | RelativePositionalEncoding | 248
5 | self_positional_encoding_v | RelativePositionalEncoding | 248
6 | transformer_blocks         | ModuleList                 | 8.2 K
7 | output_dropout             | Dropout                    | 0
--------------------------------------------------------------------------
8.4 K     Trainable params
0         Non-trainable params
8.4 K     Total params
0.033     Total estimated model params size (MB)
/home/user126/anaconda3/envs/dt_idl/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 32 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/home/user126/anaconda3/envs/dt_idl/lib/python3.11/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))



Epoch 0:  92%|█████████▎| 37/40 [00:07<00:00,  4.79it/s, loss=0.542, v_num=ro0x]
`Trainer.fit` stopped: `max_epochs=1` reached.
/home/user126/anaconda3/envs/dt_idl/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, test_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 32 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/home/user126/TFformer/model/CT_ourmodel.py:342: UserWarning: Using a target size (torch.Size([256, 59, 1])) that is different to the input size (torch.Size([256, 59, 16])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
Epoch 0: 100%|██████████| 40/40 [00:09<00:00,  4.15it/s, loss=0.543, v_num=ro0x]
Testing DataLoader 0:  50%|█████     | 2/4 [00:00<00:00, 13.31it/s]
/home/user126/TFformer/model/CT_ourmodel.py:342: UserWarning: Using a target size (torch.Size([232, 59, 1])) that is different to the input size (torch.Size([232, 59, 16])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
Testing DataLoader 0: 100%|██████████| 4/4 [00:00<00:00, 12.81it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Runningstage.testing metric      DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      test_mse_loss         1.0380428059811568
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
{"CT": "type", "DataLoader": "type", "Dataset": "type", "SyntheticCancerDatasetCollection": "type", "WandbLogger": "ABCMeta", "batch_size": "int", "config": "dict", "data_loader": "DataLoader", "dataset": "SyntheticCancerDataset", "datasetcollection": "SyntheticCancerDatasetCollection", "datetime": "type", "dim_A": "int", "dim_V": "int", "dim_X": "int", "dim_Y": "int", "epoch": "int", "get_ipython": "function", "logger": "Logger", "logging": "module", "model": "CT", "np": "module", "num_patients": "dict", "os": "module", "pd": "module", "pl": "module", "predicted_outputs": "ndarray", "projection_horizon": "int", "seed_everything": "function", "split": "float64", "sys": "module", "torch": "module", "train_loader": "DataLoader", "trainer": "Trainer", "val_loader": "DataLoader", "wandb": "module", "wandb_logger": "WandbLogger"}
{"CT": "type", "DataLoader": "type", "Dataset": "type", "SyntheticCancerDatasetCollection": "type", "WandbLogger": "ABCMeta", "batch_size": "int", "config": "dict", "data_loader": "DataLoader", "dataset": "SyntheticCancerDataset", "datasetcollection": "SyntheticCancerDatasetCollection", "datetime": "type", "dim_A": "int", "dim_V": "int", "dim_X": "int", "dim_Y": "int", "epoch": "int", "get_ipython": "function", "logger": "Logger", "logging": "module", "model": "CT", "np": "module", "num_patients": "dict", "os": "module", "pd": "module", "pl": "module", "predicted_outputs": "ndarray", "projection_horizon": "int", "seed_everything": "function", "split": "float64", "sys": "module", "torch": "module", "train_loader": "DataLoader", "trainer": "Trainer", "val_loader": "DataLoader", "wandb": "module", "wandb_logger": "WandbLogger"}
{"CT": "type", "DataLoader": "type", "Dataset": "type", "SyntheticCancerDatasetCollection": "type", "WandbLogger": "ABCMeta", "batch_size": "int", "config": "dict", "data_loader": "DataLoader", "dataset": "SyntheticCancerDataset", "datasetcollection": "SyntheticCancerDatasetCollection", "datetime": "type", "dim_A": "int", "dim_V": "int", "dim_X": "int", "dim_Y": "int", "epoch": "int", "get_ipython": "function", "logger": "Logger", "logging": "module", "model": "CT", "np": "module", "num_patients": "dict", "os": "module", "pd": "module", "pl": "module", "predicted_outputs": "ndarray", "projection_horizon": "int", "seed_everything": "function", "split": "float64", "sys": "module", "torch": "module", "train_loader": "DataLoader", "trainer": "Trainer", "val_loader": "DataLoader", "wandb": "module", "wandb_logger": "WandbLogger"}
{"CT": "type", "DataLoader": "type", "Dataset": "type", "SyntheticCancerDatasetCollection": "type", "WandbLogger": "ABCMeta", "batch_size": "int", "config": "dict", "data_loader": "DataLoader", "dataset": "SyntheticCancerDataset", "datasetcollection": "SyntheticCancerDatasetCollection", "datetime": "type", "dim_A": "int", "dim_V": "int", "dim_X": "int", "dim_Y": "int", "epoch": "int", "get_ipython": "function", "logger": "Logger", "logging": "module", "model": "CT", "np": "module", "num_patients": "dict", "os": "module", "pd": "module", "pl": "module", "predicted_outputs": "ndarray", "projection_horizon": "int", "seed_everything": "function", "split": "float64", "sys": "module", "torch": "module", "train_loader": "DataLoader", "trainer": "Trainer", "val_loader": "DataLoader", "wandb": "module", "wandb_logger": "WandbLogger"}
{"CT": "type", "DataLoader": "type", "Dataset": "type", "SyntheticCancerDatasetCollection": "type", "WandbLogger": "ABCMeta", "batch_size": "int", "config": "dict", "data_loader": "DataLoader", "dataset": "SyntheticCancerDataset", "datasetcollection": "SyntheticCancerDatasetCollection", "datetime": "type", "dim_A": "int", "dim_V": "int", "dim_X": "int", "dim_Y": "int", "epoch": "int", "get_ipython": "function", "logger": "Logger", "logging": "module", "model": "CT", "np": "module", "num_patients": "dict", "os": "module", "pd": "module", "pl": "module", "predicted_outputs": "ndarray", "projection_horizon": "int", "seed_everything": "function", "split": "float64", "sys": "module", "torch": "module", "train_loader": "DataLoader", "trainer": "Trainer", "val_loader": "DataLoader", "wandb": "module", "wandb_logger": "WandbLogger"}
{"CT": "type", "DataLoader": "type", "Dataset": "type", "SyntheticCancerDatasetCollection": "type", "WandbLogger": "ABCMeta", "batch_size": "int", "config": "dict", "data_loader": "DataLoader", "dataset": "SyntheticCancerDataset", "datasetcollection": "SyntheticCancerDatasetCollection", "datetime": "type", "dim_A": "int", "dim_V": "int", "dim_X": "int", "dim_Y": "int", "epoch": "int", "get_ipython": "function", "logger": "Logger", "logging": "module", "model": "CT", "np": "module", "num_patients": "dict", "os": "module", "pd": "module", "pl": "module", "predicted_outputs": "ndarray", "projection_horizon": "int", "seed_everything": "function", "split": "float64", "sys": "module", "torch": "module", "train_loader": "DataLoader", "trainer": "Trainer", "val_loader": "DataLoader", "wandb": "module", "wandb_logger": "WandbLogger"}
{"CT": "type", "DataLoader": "type", "Dataset": "type", "SyntheticCancerDatasetCollection": "type", "WandbLogger": "ABCMeta", "batch_size": "int", "config": "dict", "data_loader": "DataLoader", "dataset": "SyntheticCancerDataset", "datasetcollection": "SyntheticCancerDatasetCollection", "datetime": "type", "dim_A": "int", "dim_V": "int", "dim_X": "int", "dim_Y": "int", "epoch": "int", "get_ipython": "function", "logger": "Logger", "logging": "module", "model": "CT", "np": "module", "num_patients": "dict", "os": "module", "pd": "module", "pl": "module", "predicted_outputs": "ndarray", "projection_horizon": "int", "seed_everything": "function", "split": "float64", "sys": "module", "torch": "module", "train_loader": "DataLoader", "trainer": "Trainer", "val_loader": "DataLoader", "wandb": "module", "wandb_logger": "WandbLogger"}
